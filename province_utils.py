#!/usr/bin/env python3
"""
Province utilities for Thai license plates
"""

import re

# Thai provinces mapping
THAI_PROVINCES = {
    # ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£ ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏°‡∏ì‡∏ë‡∏•
    '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£': ['‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û', '‡∏Å‡∏ó‡∏°', '‡∏Å‡∏ó‡∏°.', 'bangkok'],
    '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ô‡∏ó', 'nonthaburi'],
    '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ': ['‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏õ‡∏ó', 'pathum thani'],
    '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£': ['‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£', '‡∏™‡∏õ', 'samut prakan'],
    '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£': ['‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', '‡∏™‡∏™', 'samut sakhon'],
    '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°': ['‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°', '‡∏™‡∏ã', 'samut songkhram'],
    
    # ‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠
    '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà': ['‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', '‡∏ä‡∏°', 'chiang mai'],
    '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢': ['‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', '‡∏ä‡∏£', 'chiang rai'],
    '‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô': ['‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô', '‡∏°‡∏™', 'mae hong son'],
    '‡∏ô‡πà‡∏≤‡∏ô': ['‡∏ô‡πà‡∏≤‡∏ô', '‡∏ô‡∏ô', 'nan'],
    '‡∏û‡∏∞‡πÄ‡∏¢‡∏≤': ['‡∏û‡∏∞‡πÄ‡∏¢‡∏≤', '‡∏û‡∏¢', 'phayao'],
    '‡πÅ‡∏û‡∏£‡πà': ['‡πÅ‡∏û‡∏£‡πà', '‡∏û‡∏£', 'phrae'],
    '‡∏•‡∏≥‡∏õ‡∏≤‡∏á': ['‡∏•‡∏≥‡∏õ‡∏≤‡∏á', '‡∏•‡∏õ', 'lampang'],
    '‡∏•‡∏≥‡∏û‡∏π‡∏ô': ['‡∏•‡∏≥‡∏û‡∏π‡∏ô', '‡∏•‡∏û', 'lamphun'],
    '‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå': ['‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå', '‡∏≠‡∏ï', 'uttaradit'],
    '‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢': ['‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢', '‡∏™‡∏ó', 'sukhothai'],
    '‡∏ï‡∏≤‡∏Å': ['‡∏ï‡∏≤‡∏Å', '‡∏ï‡∏Å', 'tak'],
    '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£': ['‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£', '‡∏Å‡∏û', 'kamphaeng phet'],
    '‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£': ['‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£', '‡∏û‡∏à', 'phichit'],
    '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å': ['‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å', '‡∏û‡∏•', 'phitsanulok'],
    
    # ‡∏†‡∏≤‡∏Ñ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô
    '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤': ['‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', '‡∏ô‡∏°', 'korat', 'nakhon ratchasima'],
    '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô': ['‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', '‡∏Ç‡∏Å', 'khon kaen'],
    '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ': ['‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏î', 'udon thani'],
    '‡πÄ‡∏•‡∏¢': ['‡πÄ‡∏•‡∏¢', '‡∏•‡∏¢', 'loei'],
    '‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢': ['‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢', '‡∏´‡∏ô‡∏Ñ', 'nong khai'],
    '‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π': ['‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π', '‡∏ô‡∏†', 'nong bua lam phu'],
    '‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨': ['‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨', '‡∏ö‡∏Å', 'bueng kan'],
    '‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£': ['‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£', '‡∏™‡∏ô', 'sakon nakhon'],
    '‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°': ['‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°', '‡∏ô‡∏û', 'nakhon phanom'],
    '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£': ['‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', '‡∏°‡∏´', 'mukdahan'],
    '‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå': ['‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏Å‡∏™', 'kalasin'],
    '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î': ['‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î', '‡∏£‡∏≠', 'roi et'],
    '‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°': ['‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°', '‡∏°‡∏Ñ', 'maha sarakham'],
    '‡∏¢‡∏∞‡πÇ‡∏™‡∏ò‡∏£': ['‡∏¢‡∏∞‡πÇ‡∏™‡∏ò‡∏£', '‡∏¢‡∏™', 'yasothon'],
    '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç': ['‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç', '‡∏≠‡∏à', 'amnat charoen'],
    '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ': ['‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏≠‡∏ö', 'ubon ratchathani'],
    '‡∏®‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©': ['‡∏®‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©', '‡∏®‡∏Å', 'si sa ket'],
    '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå': ['‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏™‡∏£', 'surin'],
    '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå': ['‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', '‡∏ö‡∏£', 'buriram'],
    '‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥': ['‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥', '‡∏ä‡∏¢', 'chaiyaphum'],
    
    # ‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á
    '‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå': ['‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå', '‡∏ô‡∏™', 'nakhon sawan'],
    '‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó': ['‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó', '‡∏ä‡∏ô', 'chai nat'],
    '‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏ö', 'sing buri'],
    '‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á': ['‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á', '‡∏≠‡∏ó', 'ang thong'],
    '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏£‡∏∞', 'saraburi'],
    '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ', '‡∏•‡∏ö', 'lopburi'],
    '‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤': ['‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', '‡∏≠‡∏¢', 'ayutthaya', '‡∏û‡∏£‡∏∞‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤'],
    '‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ', '‡∏™‡∏û', 'suphanburi'],
    '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏Å‡∏à', 'kanchanaburi'],
    '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ': ['‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡∏û‡∏ö', 'phetchaburi'],
    '‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå': ['‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå', '‡∏õ‡∏Ç', 'prachuap khiri khan'],
    '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°': ['‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', '‡∏ô‡∏ê', 'nakhon pathom'],
    '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', '‡∏£‡∏ö', 'ratchaburi'],
    
    # ‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å
    '‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤': ['‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤', '‡∏â‡∏ä', 'chachoengsao'],
    '‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏õ‡∏à', 'prachin buri'],
    '‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å': ['‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å', '‡∏ô‡∏¢', 'nakhon nayok'],
    '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ä‡∏ö', 'chonburi'],
    '‡∏£‡∏∞‡∏¢‡∏≠‡∏á': ['‡∏£‡∏∞‡∏¢‡∏≠‡∏á', '‡∏£‡∏¢', 'rayong'],
    '‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏à‡∏ö', 'chanthaburi'],
    '‡∏ï‡∏£‡∏≤‡∏î': ['‡∏ï‡∏£‡∏≤‡∏î', '‡∏ï‡∏î', 'trat'],
    '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß': ['‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß', '‡∏™‡∏Å', 'sa kaeo'],
    
    # ‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ
    '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå': ['‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå', '‡∏û‡∏ä', 'phetchabun'],
    '‡∏ä‡∏∏‡∏°‡∏û‡∏£': ['‡∏ä‡∏∏‡∏°‡∏û‡∏£', '‡∏ä‡∏û', 'chumphon'],
    '‡∏£‡∏∞‡∏ô‡∏≠‡∏á': ['‡∏£‡∏∞‡∏ô‡∏≠‡∏á', '‡∏£‡∏ô', 'ranong'],
    '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ': ['‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏™‡∏é', 'surat thani'],
    '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä': ['‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', '‡∏ô‡∏®', 'nakhon si thammarat'],
    '‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà': ['‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà', '‡∏Å‡∏ö', 'krabi'],
    '‡∏û‡∏±‡∏á‡∏á‡∏≤': ['‡∏û‡∏±‡∏á‡∏á‡∏≤', '‡∏û‡∏á', 'phang nga'],
    '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï': ['‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï', '‡∏†‡∏Å', 'phuket'],
    '‡∏ï‡∏£‡∏±‡∏á': ['‡∏ï‡∏£‡∏±‡∏á', '‡∏ï‡∏£', 'trang'],
    '‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á': ['‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á', '‡∏û‡∏ó', 'phatthalung'],
    '‡∏™‡∏á‡∏Ç‡∏•‡∏≤': ['‡∏™‡∏á‡∏Ç‡∏•‡∏≤', '‡∏™‡∏Ç', 'songkhla'],
    '‡∏™‡∏ï‡∏π‡∏•': ['‡∏™‡∏ï‡∏π‡∏•', '‡∏™‡∏ï', 'satun'],
    '‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ': ['‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ', '‡∏õ‡∏ï', 'pattani'],
    '‡∏¢‡∏∞‡∏•‡∏≤': ['‡∏¢‡∏∞‡∏•‡∏≤', '‡∏¢‡∏•', 'yala'],
    '‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™': ['‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™', '‡∏ô‡∏ò', 'narathiwat']
}

def extract_province_from_plate(license_plate):
    """
    Extract province from Thai license plate text
    
    Args:
        license_plate: License plate text
        
    Returns:
        tuple: (province_name, confidence)
    """
    if not license_plate:
        return None, 0.0
    
    # Clean the input
    plate_text = license_plate.strip().lower()
    
    # Try exact matches first
    for province, variations in THAI_PROVINCES.items():
        for variation in variations:
            if variation.lower() in plate_text:
                return province, 1.0
    
    # Try partial matches with common patterns
    # Pattern: XX #### PROVINCE or PROVINCE XX ####
    words = plate_text.split()
    
    for word in words:
        word_clean = word.strip('.,!?()[]{}')
        for province, variations in THAI_PROVINCES.items():
            for variation in variations:
                # Fuzzy matching
                if (len(word_clean) > 2 and 
                    (word_clean in variation.lower() or 
                     variation.lower() in word_clean)):
                    return province, 0.8
    
    # Special patterns for common abbreviations
    abbreviation_patterns = {
        '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û': ['‡∏Å‡∏ó‡∏°', 'bkk', 'bangkok', '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£'],
        '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà': ['‡∏ä‡∏°', 'cm', 'chiangmai'],
        '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢': ['‡∏ä‡∏£', 'cr', 'chiangrai'],
        '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô': ['‡∏Ç‡∏Å', 'kk', 'khonkaen'],
        '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤': ['‡∏ô‡∏°', 'korat', 'nakhonratchasima'],
        '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï': ['‡∏†‡∏Å', 'phuket'],
        '‡∏™‡∏á‡∏Ç‡∏•‡∏≤': ['‡∏™‡∏Ç', 'songkhla'],
        '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ': ['‡∏ä‡∏ö', 'chonburi', 'pattaya']
    }
    
    for province, patterns in abbreviation_patterns.items():
        for pattern in patterns:
            if pattern.lower() in plate_text:
                return province, 0.9
    
    return None, 0.0

def get_province_region(province):
    """
    Get region of a province
    
    Args:
        province: Province name
        
    Returns:
        str: Region name
    """
    regions = {
        '‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠': [
            '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà', '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏£‡∏≤‡∏¢', '‡πÅ‡∏°‡πà‡∏Æ‡πà‡∏≠‡∏á‡∏™‡∏≠‡∏ô', '‡∏ô‡πà‡∏≤‡∏ô', '‡∏û‡∏∞‡πÄ‡∏¢‡∏≤', '‡πÅ‡∏û‡∏£‡πà',
            '‡∏•‡∏≥‡∏õ‡∏≤‡∏á', '‡∏•‡∏≥‡∏û‡∏π‡∏ô', '‡∏≠‡∏∏‡∏ï‡∏£‡∏î‡∏¥‡∏ï‡∏ñ‡πå', '‡∏™‡∏∏‡πÇ‡∏Ç‡∏ó‡∏±‡∏¢', '‡∏ï‡∏≤‡∏Å', '‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏û‡∏ä‡∏£',
            '‡∏û‡∏¥‡∏à‡∏¥‡∏ï‡∏£', '‡∏û‡∏¥‡∏©‡∏ì‡∏∏‡πÇ‡∏•‡∏Å'
        ],
        '‡∏†‡∏≤‡∏Ñ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô': [
            '‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤', '‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô', '‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ', '‡πÄ‡∏•‡∏¢', '‡∏´‡∏ô‡∏≠‡∏á‡∏Ñ‡∏≤‡∏¢', '‡∏´‡∏ô‡∏≠‡∏á‡∏ö‡∏±‡∏ß‡∏•‡∏≥‡∏†‡∏π',
            '‡∏ö‡∏∂‡∏á‡∏Å‡∏≤‡∏¨', '‡∏™‡∏Å‡∏•‡∏ô‡∏Ñ‡∏£', '‡∏ô‡∏Ñ‡∏£‡∏û‡∏ô‡∏°', '‡∏°‡∏∏‡∏Å‡∏î‡∏≤‡∏´‡∏≤‡∏£', '‡∏Å‡∏≤‡∏¨‡∏™‡∏¥‡∏ô‡∏ò‡∏∏‡πå', '‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏≠‡πá‡∏î',
            '‡∏°‡∏´‡∏≤‡∏™‡∏≤‡∏£‡∏Ñ‡∏≤‡∏°', '‡∏¢‡∏∞‡πÇ‡∏™‡∏ò‡∏£', '‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡πÄ‡∏à‡∏£‡∏¥‡∏ç', '‡∏≠‡∏∏‡∏ö‡∏•‡∏£‡∏≤‡∏ä‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏®‡∏µ‡∏™‡∏∞‡πÄ‡∏Å‡∏©',
            '‡∏™‡∏∏‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå', '‡∏ö‡∏∏‡∏£‡∏µ‡∏£‡∏±‡∏°‡∏¢‡πå', '‡∏ä‡∏±‡∏¢‡∏†‡∏π‡∏°‡∏¥'
        ],
        '‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á': [
            '‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå', '‡∏ä‡∏±‡∏¢‡∏ô‡∏≤‡∏ó', '‡∏™‡∏¥‡∏á‡∏´‡πå‡∏ö‡∏∏‡∏£‡∏µ', '‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á', '‡∏™‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏µ', '‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ',
            '‡∏≠‡∏¢‡∏∏‡∏ò‡∏¢‡∏≤', '‡∏™‡∏∏‡∏û‡∏£‡∏£‡∏ì‡∏ö‡∏∏‡∏£‡∏µ', '‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏∏‡∏£‡∏µ', '‡∏õ‡∏£‡∏∞‡∏à‡∏ß‡∏ö‡∏Ñ‡∏µ‡∏£‡∏µ‡∏Ç‡∏±‡∏ô‡∏ò‡πå',
            '‡∏ô‡∏Ñ‡∏£‡∏õ‡∏ê‡∏°', '‡∏£‡∏≤‡∏ä‡∏ö‡∏∏‡∏£‡∏µ', '‡πÄ‡∏û‡∏ä‡∏£‡∏ö‡∏π‡∏£‡∏ì‡πå'
        ],
        '‡∏†‡∏≤‡∏Ñ‡∏ï‡∏∞‡∏ß‡∏±‡∏ô‡∏≠‡∏≠‡∏Å': [
            '‡∏â‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏£‡∏≤', '‡∏õ‡∏£‡∏≤‡∏à‡∏µ‡∏ô‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ô‡∏Ñ‡∏£‡∏ô‡∏≤‡∏¢‡∏Å', '‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ', '‡∏£‡∏∞‡∏¢‡∏≠‡∏á',
            '‡∏à‡∏±‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏ï‡∏£‡∏≤‡∏î', '‡∏™‡∏£‡∏∞‡πÅ‡∏Å‡πâ‡∏ß'
        ],
        '‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ': [
            '‡∏ä‡∏∏‡∏°‡∏û‡∏£', '‡∏£‡∏∞‡∏ô‡∏≠‡∏á', '‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏ô‡∏Ñ‡∏£‡∏®‡∏£‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏£‡∏≤‡∏ä', '‡∏Å‡∏£‡∏∞‡∏ö‡∏µ‡πà',
            '‡∏û‡∏±‡∏á‡∏á‡∏≤', '‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï', '‡∏ï‡∏£‡∏±‡∏á', '‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á', '‡∏™‡∏á‡∏Ç‡∏•‡∏≤', '‡∏™‡∏ï‡∏π‡∏•',
            '‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ', '‡∏¢‡∏∞‡∏•‡∏≤', '‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™'
        ],
        '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏°‡∏ì‡∏ë‡∏•': [
            '‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£', '‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ', '‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£',
            '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏≤‡∏Ñ‡∏£', '‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏™‡∏á‡∏Ñ‡∏£‡∏≤‡∏°'
        ]
    }
    
    for region, provinces in regions.items():
        if province in provinces:
            return region
    
    return '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'

def analyze_license_plate(license_plate):
    """
    Analyze license plate and extract all information
    
    Args:
        license_plate: License plate text
        
    Returns:
        dict: Analysis results
    """
    province, confidence = extract_province_from_plate(license_plate)
    region = get_province_region(province) if province else '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'
    
    return {
        'license_plate': license_plate,
        'province': province,
        'province_confidence': confidence,
        'region': region,
        'analysis_success': province is not None
    }

if __name__ == "__main__":
    # Test cases
    test_plates = [
        "‡∏Å‡∏Å 1234 ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û",
        "‡∏Ç‡∏Ç 5678 ‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà",
        "‡∏ô‡∏™ 9999 ‡∏ô‡∏Ñ‡∏£‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå",
        "ABC 123 Bangkok",
        "1234 ‡∏Å‡∏ó‡∏°",
        "‡∏ä‡∏° 4567"
    ]
    
    print("üîç Testing Province Extraction:")
    print("=" * 50)
    
    for plate in test_plates:
        result = analyze_license_plate(plate)
        print(f"üìã {plate}")
        print(f"   üèõÔ∏è ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î: {result['province']} ({result['province_confidence']:.1f})")
        print(f"   üó∫Ô∏è ‡∏†‡∏≤‡∏Ñ: {result['region']}")
        print(f"   ‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: {result['analysis_success']}")
        print()
